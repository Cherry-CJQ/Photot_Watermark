# Photo Watermark Tool - Project Requirements Document (PRT)

## 项目概述
这是一个基于Java的命令行照片水印工具，用于为图片添加基于EXIF拍摄时间的文字水印。

## 功能需求

### 核心功能
1. **图片路径输入**
   - 用户通过命令行参数输入图片文件路径
   - 支持单个文件或目录路径
   - 自动识别图片格式（JPG, PNG, GIF等）

2. **EXIF信息读取**
   - 读取图片的EXIF元数据
   - 提取拍摄时间信息
   - 格式化为年月日格式作为水印文本

3. **水印配置**
   - 字体大小设置（默认24pt）
   - 字体颜色设置（默认白色）
   - 水印位置选择（左上角、居中、右下角）

4. **图片处理**
   - 在原图上绘制文字水印
   - 保持原始图片质量
   - 生成新的水印图片文件

5. **输出管理**
   - 创建原目录的子目录：`原目录名_watermark`
   - 将处理后的图片保存到该目录
   - 保持原始文件名或添加后缀标识

### 技术需求
- **编程语言**: Java 8+
- **依赖库**:
  - Apache Commons Imaging (EXIF读取)
  - Java ImageIO (图片处理)
- **构建工具**: Maven/Gradle
- **运行环境**: JDK 8+

### 用户界面
- 命令行界面
- 参数说明和帮助信息
- 错误处理和提示信息

### 异常处理
- 文件不存在或无法访问
- EXIF信息缺失
- 图片格式不支持
- 磁盘空间不足

## 实现计划

### Phase 1: 项目搭建
- 创建Maven项目结构
- 配置依赖
- 实现基础框架

### Phase 2: 核心功能开发
- EXIF信息读取模块
- 图片处理模块
- 水印绘制模块

### Phase 3: 配置和输出
- 命令行参数解析
- 输出目录管理
- 文件保存逻辑

### Phase 4: 测试和优化
- 单元测试
- 性能优化
- 错误处理完善

## 验收标准
1. 能够正确读取图片EXIF信息
2. 水印文字清晰可读
3. 输出文件保存在正确位置
4. 支持多种图片格式
5. 命令行参数正确解析
6. 错误情况有适当提示

## 项目结构
```
photot_watermark/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── photowatermark/
│   │   │           ├── Main.java
│   │   │           ├── core/
│   │   │           │   ├── ExifReader.java
│   │   │           │   ├── ImageProcessor.java
│   │   │           │   └── WatermarkGenerator.java
│   │   │           └── utils/
│   │   │               ├── FileUtils.java
│   │   │               └── ConfigParser.java
│   │   └── resources/
│   └── test/
│       └── java/
├── pom.xml
├── README.md
└── PRT.md
```

## 风险评估
1. **EXIF信息缺失**: 某些图片可能没有EXIF数据，需要提供默认处理方案
2. **图片格式兼容性**: 不同格式的图片处理方式不同，需要充分测试
3. **性能问题**: 大量图片处理时可能出现内存或性能问题
4. **字体渲染**: 不同系统字体渲染效果可能不同

## 后续计划
1. 实现基础版本
2. 添加更多水印样式选项
3. 支持批量处理优化
4. 添加GUI界面版本
